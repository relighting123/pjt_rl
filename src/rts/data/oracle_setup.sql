-- RTS Oracle DB Table Cleanup & Creation Scripts

-- 0. Cleanup Existing Tables
DROP TABLE RTS_RESLT_INF CASCADE CONSTRAINTS PURGE;
DROP TABLE RTS_EQP_DT_INF CASCADE CONSTRAINTS PURGE;
DROP TABLE RTS_PLAN_WIP_INF CASCADE CONSTRAINTS PURGE;
DROP TABLE RTS_EQP_INV_INF CASCADE CONSTRAINTS PURGE;
DROP TABLE RTS_CO_RULE_INF CASCADE CONSTRAINTS PURGE;
DROP TABLE RTS_EQP_CAPA_INF CASCADE CONSTRAINTS PURGE;

-- 1. Equipment Capabilities Table
CREATE TABLE RTS_EQP_CAPA_INF (
    RULE_TIMEKEY    VARCHAR2(14) NOT NULL,
    PRODUCT         VARCHAR2(100) NOT NULL,
    PROCESS         VARCHAR2(100) NOT NULL,
    MODEL           VARCHAR2(100) NOT NULL,
    ST              NUMBER(10, 2),
    FEASIBLE        CHAR(1) DEFAULT 'Y',
    INITIAL_COUNT   NUMBER(10) DEFAULT 0,
    CRT_USER_ID     VARCHAR2(20) DEFAULT 'RTS',
    CRT_TM          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CHG_USER_ID     VARCHAR2(20) DEFAULT 'RTS',
    CHG_TM          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT PK_RTS_EQP_CAPA PRIMARY KEY (RULE_TIMEKEY, PRODUCT, PROCESS, MODEL)
);

-- 2. Changeover Rules Table
CREATE TABLE RTS_CO_RULE_INF (
    RULE_TIMEKEY    VARCHAR2(14) NOT NULL,
    FROM_PRODUCT    VARCHAR2(100) NOT NULL,
    FROM_PROCESS    VARCHAR2(100) NOT NULL,
    TO_PRODUCT      VARCHAR2(100) NOT NULL,
    TO_PROCESS      VARCHAR2(100) NOT NULL,
    CO_TIME         NUMBER(10, 2),
    DEFAULT_TIME    NUMBER(10, 2),
    CRT_USER_ID     VARCHAR2(20) DEFAULT 'RTS',
    CRT_TM          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CHG_USER_ID     VARCHAR2(20) DEFAULT 'RTS',
    CHG_TM          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT PK_RTS_CO_RULE PRIMARY KEY (RULE_TIMEKEY, FROM_PRODUCT, FROM_PROCESS, TO_PRODUCT, TO_PROCESS)
);

-- 3. Equipment Inventory Table
CREATE TABLE RTS_EQP_INV_INF (
    RULE_TIMEKEY    VARCHAR2(14) NOT NULL,
    MODEL           VARCHAR2(100) NOT NULL,
    CNT             NUMBER(10) DEFAULT 0,
    CRT_USER_ID     VARCHAR2(20) DEFAULT 'RTS',
    CRT_TM          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CHG_USER_ID     VARCHAR2(20) DEFAULT 'RTS',
    CHG_TM          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT PK_RTS_EQP_INV PRIMARY KEY (RULE_TIMEKEY, MODEL)
);

-- 4. Plan and WIP Table
CREATE TABLE RTS_PLAN_WIP_INF (
    RULE_TIMEKEY    VARCHAR2(14) NOT NULL,
    PRODUCT         VARCHAR2(100) NOT NULL,
    PROCESS         VARCHAR2(100) NOT NULL,
    OPER_SEQ        NUMBER(10),
    WIP             NUMBER(10, 2),
    PLAN            NUMBER(10, 2),
    CRT_USER_ID     VARCHAR2(20) DEFAULT 'RTS',
    CRT_TM          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CHG_USER_ID     VARCHAR2(20) DEFAULT 'RTS',
    CHG_TM          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT PK_RTS_PLAN_WIP PRIMARY KEY (RULE_TIMEKEY, PRODUCT, PROCESS)
);

-- 5. Equipment Downtime Table
CREATE TABLE RTS_EQP_DT_INF (
    RULE_TIMEKEY    VARCHAR2(14) NOT NULL,
    MODEL           VARCHAR2(100) NOT NULL,
    START_STEP      NUMBER(10) NOT NULL,
    END_STEP        NUMBER(10) NOT NULL,
    CNT             NUMBER(10) DEFAULT 0,
    CRT_USER_ID     VARCHAR2(20) DEFAULT 'RTS',
    CRT_TM          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CHG_USER_ID     VARCHAR2(20) DEFAULT 'RTS',
    CHG_TM          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT PK_RTS_EQP_DT PRIMARY KEY (RULE_TIMEKEY, MODEL, START_STEP, END_STEP)
);

-- 6. Inference Results Table
CREATE TABLE RTS_RESLT_INF (
    RULE_TIMEKEY    VARCHAR2(14) NOT NULL,
    SIM_STEP        NUMBER(10) NOT NULL,
    PRODUCT         VARCHAR2(100) NOT NULL,
    PROCESS         VARCHAR2(100) NOT NULL,
    WIP             NUMBER(10, 2),
    PRODUCTION      NUMBER(10, 2),
    ACTIVE_EQP      NUMBER(10, 2),
    TARGET_EQP      NUMBER(10, 2),
    UNAVAILABLE_EQP NUMBER(10, 2),
    PLAN            NUMBER(10, 2),
    PRODUCED_SUM    NUMBER(10, 2),
    TOTAL_CO        NUMBER(10),
    CRT_USER_ID     VARCHAR2(20) DEFAULT 'RTS',
    CRT_TM          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CHG_USER_ID     VARCHAR2(20) DEFAULT 'RTS',
    CHG_TM          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT PK_RTS_RESLT PRIMARY KEY (RULE_TIMEKEY, SIM_STEP, PRODUCT, PROCESS)
);

-- Sample Data Insertion (Scenario 1 to 5)
-- (Generated logic already provided in all_scenarios_inserts.sql)
-- ... [INSERT STATEMENTS HERE] ...
